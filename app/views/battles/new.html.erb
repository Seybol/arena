<div class="container py-5">
  <div class="row mb-4">
    <div class="col">
      <h1 class="display-4 text-white text-center">Select Your Fighters</h1>
    </div>
  </div>

  <%= form_with url: battles_path, method: :post do |f| %>
    <div class="row g-4">
      <!-- Fighter 1 Selection -->
      <div class="col-md-6">
        <div class="card bg-dark text-white border-danger h-100">
          <div class="card-header bg-danger">
            <h2 class="h4 mb-0">Fighter 1</h2>
          </div>
          <div class="card-body">
            <!-- Fighters Grid -->
            <div class="row g-3 mb-4">
              <% @fighters.each do |fighter| %>
                <div class="col-sm-6">
                  <%= f.radio_button :fighter1_id, fighter.id, class: "position-absolute invisible fighter-select" %>
                  <%= f.label "fighter1_id_#{fighter.id}", class: "w-100" do %>
                    <div class="fighter-card card bg-dark text-white border-secondary h-100">
                      <div class="card-body">
                        <h5 class="card-title"><%= fighter.name %></h5>
                        <div class="mt-2">
                          <div class="d-flex justify-content-between mb-2">
                            <span>HP</span>
                            <div class="progress flex-grow-1 mx-2" style="height: 20px;">
                              <div class="progress-bar bg-danger" style="width: <%= (fighter.health_points.to_f / 150 * 100).round %>%">
                                <%= fighter.health_points %>
                              </div>
                            </div>
                          </div>
                          <div class="d-flex justify-content-between">
                            <span>ATK</span>
                            <div class="progress flex-grow-1 mx-2" style="height: 20px;">
                              <div class="progress-bar bg-primary" style="width: <%= (fighter.attack_points.to_f / 25 * 100).round %>%">
                                <%= fighter.attack_points %>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>

            <!-- Weapon Selection -->
            <h3 class="h5 mb-3">Choose Weapon</h3>
            <div class="row g-3">
              <div class="col-6">
                <div class="position-relative">
                  <%= f.radio_button :fighter1_weapon_id, "", class: "position-absolute invisible weapon-select" %>
                  <label for="fighter1_weapon_id_" class="weapon-card card bg-dark text-white border-secondary h-100">
                    <div class="card-body text-center">
                      <p class="mb-0">No Weapon</p>
                    </div>
                  </label>
                </div>
              </div>
              
              <% @weapons.each do |weapon| %>
                <div class="col-6">
                  <div class="position-relative">
                    <%= f.radio_button :fighter1_weapon_id, weapon.id, class: "position-absolute invisible weapon-select" %>
                    <label for="fighter1_weapon_id_<%= weapon.id %>" class="weapon-card card bg-dark text-white border-secondary h-100">
                      <div class="card-body text-center">
                        <h6 class="card-title"><%= weapon.name %></h6>
                        <p class="text-warning mb-0">+<%= weapon.attack_bonus %> ATK</p>
                      </div>
                    </label>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>

      <!-- Fighter 2 Selection (Similar structure with blue theme) -->
      <div class="col-md-6">
        <div class="card bg-dark text-white border-primary h-100">
          <div class="card-header bg-primary">
            <h2 class="h4 mb-0">Fighter 2</h2>
          </div>
          <div class="card-body">
            <!-- Fighters Grid -->
            <div class="row g-3 mb-4">
              <% @fighters.each do |fighter| %>
                <div class="col-sm-6">
                  <%= f.radio_button :fighter2_id, fighter.id, class: "position-absolute invisible fighter-select" %>
                  <%= f.label "fighter2_id_#{fighter.id}", class: "w-100" do %>
                    <div class="fighter-card card bg-dark text-white border-secondary h-100">
                      <div class="card-body">
                        <h5 class="card-title"><%= fighter.name %></h5>
                        <div class="mt-2">
                          <div class="d-flex justify-content-between mb-2">
                            <span>HP</span>
                            <div class="progress flex-grow-1 mx-2" style="height: 20px;">
                              <div class="progress-bar bg-danger" style="width: <%= (fighter.health_points.to_f / 150 * 100).round %>%">
                                <%= fighter.health_points %>
                              </div>
                            </div>
                          </div>
                          <div class="d-flex justify-content-between">
                            <span>ATK</span>
                            <div class="progress flex-grow-1 mx-2" style="height: 20px;">
                              <div class="progress-bar bg-primary" style="width: <%= (fighter.attack_points.to_f / 25 * 100).round %>%">
                                <%= fighter.attack_points %>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  <% end %>
                </div>
              <% end %>
            </div>

            <!-- Weapon Selection -->
            <h3 class="h5 mb-3">Choose Weapon</h3>
            <div class="row g-3">
              <div class="col-6">
                <div class="position-relative">
                  <%= f.radio_button :fighter2_weapon_id, "", class: "position-absolute invisible weapon-select" %>
                  <label for="fighter2_weapon_id_" class="weapon-card card bg-dark text-white border-secondary h-100">
                    <div class="card-body text-center">
                      <p class="mb-0">No Weapon</p>
                    </div>
                  </label>
                </div>
              </div>
              
              <% @weapons.each do |weapon| %>
                <div class="col-6">
                  <div class="position-relative">
                    <%= f.radio_button :fighter2_weapon_id, weapon.id, class: "position-absolute invisible weapon-select" %>
                    <label for="fighter2_weapon_id_<%= weapon.id %>" class="weapon-card card bg-dark text-white border-secondary h-100">
                      <div class="card-body text-center">
                        <h6 class="card-title"><%= weapon.name %></h6>
                        <p class="text-warning mb-0">+<%= weapon.attack_bonus %> ATK</p>
                      </div>
                    </label>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-4">
      <%= link_to 'Cancel', root_path, class: 'btn btn-secondary me-2' %>
      <%= f.submit "Start Battle!", class: 'btn btn-danger btn-lg' %>
    </div>
  <% end %>
</div>
